# Test sources

Test sources contain base classes to be used in tests, actual tests and traits that provide commonly used behaviors.

## Base classes

DSL scripts' tests are expected to inherit necessary test environment setup from base classes.

#### InMemoryDslSpecBase

Uses in-memory job management to quickly tests DSL scripts that do not use Dynamic DSLs nor extension points.

#### JenkinsDslSpecBase

Uses [Jenkins Unit Test Harness](https://github.com/jenkinsci/jenkins-test-harness) and Jenkins plugins declared in jenkins_plugins.gradle script in order to allow for testing DSL scripts that use Dynamic DSLs.

## Test cases

Test cases contain the following:
* tests that can be reused in other projects with minimal or no changes (e.g. to check DSL scripts syntax correctness)
* test samples that showcase how to test DSL scripts or custom DSL code
* helper/utility classes useful during testing DSL scripts or migrating manually created jobs to DSL scripts

#### configxml.ConfigXmlEqualitySpec

Compares XMLs generated by DSL script with config XMLs from expected-configs resource directory.

#### configxml.ExpectedXmlConfigGenerator

(Re-)generates config XMLs in expected-configs resource directory based on provided DSL script.

Useful when config XMLs are expected to change and it's easier to verify changes in XML files instead of introducing them in config XMLs.

In order to run `persistUpdatedXmlConfigs` environment variable must be set to `true`.

#### custom.TimestamperSpec

Sample test that shows how to check whether custom code results in expected changes in generated config XML.

#### job.SampleJobsSpec

Sample test that shows how to check whether job created by DSL script does what it's supposed to do.

#### job.SamplesSpec

Sample test that shows how to check whether DSL script generates expected jobs and/or views.

#### migration.MigrationHelper

Compares XML generated by DSL script with job config XML from migration-targets resource directory.
Job config XML is supposed to be copied from actual Jenkins job config.xml that was created manually and is supposed to be migrated to DSL script.

The test is not expected to pass, it's purpose is helping to migrate manually created jobs to DSL scripts and visualizing progress of such migrations.
For visual help (a.k.a. diff) click `<Click to see difference>` link in the test output in [IntelliJ IDEA](https://www.jetbrains.com/idea/)
(feature not tested in other IDEs, however IDEs supporting JUnit tests should provide some form of support for visualizing config XMLs' differences).

In order to run `runDslMigrationTests` environment variable must be set to `true`.

#### syntax.DslScriptsSyntaxSpec

Checks DSL scripts' syntax correctness
